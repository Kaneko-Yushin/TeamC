<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>デジタル介護日誌ホーム</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    :root {
      --brand:#4C9F70;
      --tile-bg:#fff;
    }
    body{background:#f3f6f5;font-family:"Hiragino Kaku Gothic ProN","Meiryo",sans-serif;}
    .navbar{background:var(--brand);}
    .brand{color:#fff;font-weight:700;letter-spacing:.06em}
    .brand small{opacity:.9;font-weight:500}
    .user-chip{color:#fff;opacity:.95}
    .menu-wrap{max-width:1100px;margin:48px auto}
    .tile{
      background:var(--tile-bg);
      border:none;border-radius:20px;
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      padding:28px 20px;
      text-align:center;
      transition:transform .15s ease, box-shadow .15s ease;
      height:100%;
    }
    .tile:hover{transform:translateY(-3px);box-shadow:0 10px 24px rgba(0,0,0,.08)}
    .tile .emoji{font-size:44px;line-height:1}
    .tile h5{margin-top:14px;margin-bottom:0;font-weight:700;color:#2c3e35}
    .tile p{margin:6px 0 0;color:#6b7d75;font-size:.95rem}
    .disabled-tile{opacity:.5;pointer-events:none;filter:grayscale(.1)}
    .section-title{font-weight:800;letter-spacing:.12em;color:#2b3f35;text-align:center;margin-bottom:26px}
    @media (max-width: 575.98px){ .tile{padding:22px 16px} .tile .emoji{font-size:38px} }
  </style>
</head>
<body>

  <!-- Top bar -->
  <nav class="navbar navbar-expand-md">
    <div class="container">
      <a class="navbar-brand brand" href="/">デジタル介護日誌 <small>Care App</small></a>

      <div class="ms-auto d-flex align-items-center gap-3">
        {% if staff_name %}
          <span class="user-chip">
            {{ staff_name }}（{{ staff_role or 'スタッフ' }}）
          </span>
          <a href="{{ url_for('logout') }}" class="btn btn-light btn-sm">ログアウト</a>
        {% else %}
          <a href="{{ url_for('staff_login') }}" class="btn btn-light btn-sm">ログイン</a>
          <a href="{{ url_for('staff_register') }}" class="btn btn-outline-light btn-sm">新規登録</a>
        {% endif %}
      </div>
    </div>
  </nav>

  <div class="container menu-wrap">
    {% if staff_name %}
      <h2 class="section-title">メインメニュー</h2>

      <div class="row g-4">
        <div class="col-12 col-sm-6 col-lg-3">
          <a class="text-decoration-none d-block h-100" href="{{ url_for('users_page') }}">
            <div class="tile">
              <div class="emoji">👥</div>
              <h5>利用者一覧</h5>
              <p>登録されている利用者を確認</p>
            </div>
          </a>
        </div>

        <div class="col-12 col-sm-6 col-lg-3">
          <a class="text-decoration-none d-block h-100" href="{{ url_for('add_record') }}">
            <div class="tile">
              <div class="emoji">📝</div>
              <h5>記録入力</h5>
              <p>食事・服薬・排泄・体調など</p>
            </div>
          </a>
        </div>

        <div class="col-12 col-sm-6 col-lg-3">
          <a class="text-decoration-none d-block h-100" href="{{ url_for('records') }}">
            <div class="tile">
              <div class="emoji">📖</div>
              <h5>記録一覧</h5>
              <p>これまでの記録を閲覧</p>
            </div>
          </a>
        </div>

        <!-- 利用者登録（管理者のみアクティブ） -->
        <div class="col-12 col-sm-6 col-lg-3">
          {% set is_admin = (staff_role in ['管理者','admin','Admin','ADMIN']) %}
          <a class="text-decoration-none d-block h-100 {% if not is_admin %}disabled-tile{% endif %}"
             href="{% if is_admin %}{{ url_for('add_user') }}{% else %}#{% endif %}">
            <div class="tile">
              <div class="emoji">➕</div>
              <h5>利用者登録</h5>
              <p>{% if is_admin %}新規利用者を追加{% else %}管理者のみ{% endif %}</p>
            </div>
          </a>
        </div>

        <!-- 2行目中央：設定 -->
        <div class="col-12 col-sm-8 col-lg-4 offset-sm-2 offset-lg-4">
          <a class="text-decoration-none d-block h-100" href="{{ url_for('admin_page') }}">
            <div class="tile">
              <div class="emoji">⚙️</div>
              <h5>設定</h5>
              <p>スタッフ・QR発行など</p>
            </div>
          </a>
        </div>
      </div>

      <div class="row g-4 mt-2">
        <div class="col-12 col-sm-6 col-lg-4 mx-auto">
          <a class="text-decoration-none d-block h-100" href="{{ url_for('handover') }}">
            <div class="tile">
              <div class="emoji">🗂️</div>
              <h5>引継ぎボード</h5>
              <p>当日の申し送り・シフト別</p>
            </div>
          </a>
        </div>
      </div>
      -->

    {% else %}
      <!-- 未ログイン時 -->
      <div class="text-center py-5">
        <h2 class="mb-3">ようこそ 👋</h2>
        <p class="text-muted mb-4">ご利用にはログインが必要です。</p>
        <a href="{{ url_for('staff_login') }}" class="btn btn-success btn-lg me-2">ログイン</a>
        <a href="{{ url_for('staff_register') }}" class="btn btn-outline-success btn-lg">新規スタッフ登録</a>
      </div>
    {% endif %}
  </div>

  <footer class="text-center text-muted pb-4 mt-5">
    <small>© 2025 デジタル介護プロジェクト</small>
  </footer>

</body>
</html>

