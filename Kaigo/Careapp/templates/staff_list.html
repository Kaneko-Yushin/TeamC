{% extends "base.html" %}
{% block body %}
<div class="header">
  <h2>ğŸ‘©â€ğŸ’¼ {{ _('StaffList') }}</h2>
  <p>{{ current_lang=='ja' and 'ç™»éŒ²æ¸ˆã¿ã‚¹ã‚¿ãƒƒãƒ•ã®ç¢ºèªã¨ç®¡ç†' or 'Manage registered staff' }}</p>
</div>

<div class="container mt-4">
  {% with msgs = get_flashed_messages() %}
    {% if msgs %}
      <div class="alert alert-info">{{ msgs[-1] }}</div>
    {% endif %}
  {% endwith %}

  <table class="table table-striped align-middle bg-white cardx">
    <thead>
      <tr>
        <th>ID</th>
        <th>{{ _('name') }}</th>
        <th>{{ _('role') }}</th>
        <th>{{ _('qr_login') }}</th>
        <th>{{ current_lang=='ja' and 'æ“ä½œ' or 'Actions' }}</th>
      </tr>
    </thead>
    <tbody>
      {% for s in staff_list %}
      <tr>
        <td>{{ s[0] }}</td>
        <td>{{ s[1] }}</td>
        <td>
          {% if s[3] == 'admin' %}{{ _('role_admin') }}
          {% elif s[3] == 'caregiver' %}{{ _('role_caregiver') }}
          {% else %}-{% endif %}
        </td>
        <td>
          {% if s[4] %}
            <a href="{{ url_for('staff_admin_bp.login_by_qr', token=s[4]) }}" target="_blank">ğŸ”— {{ _('qr_link') }}</a>
          {% else %}
            <span class="text-muted">{{ _('not_issued') }}</span>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('staff_admin_bp.qr_reissue', name=s[1]) }}" class="btn btn-sm btn-success">{{ _('qr_reissue') }}</a>
          <a href="{{ url_for('staff_admin_bp.delete_staff', sid=s[0]) }}" class="btn btn-sm btn-danger"
             onclick="return confirm('{{ _('really_delete') }}');">{{ _('delete_staff') }}</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="text-center mt-3">
    <a href="{{ url_for('staff_admin_bp.generate_qr') }}" class="btn btn-primary">{{ _('qr_new') }}</a>
    <a href="{{ url_for('staff_admin_bp.admin_page') }}" class="btn btn-outline-secondary ms-2">{{ _('back_admin') }}</a>
  </div>
</div>
{% endblock %}

